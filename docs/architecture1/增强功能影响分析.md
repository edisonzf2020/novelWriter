# 增强功能影响分析

## 需要修改的文件

  * `novelwriter/gui/main_window.py`: 需要添加代码来调用 `MainWindowIntegration.integrate_ai_dock()`。
  * `novelwriter/core/config.py`: 需要添加 `@property` 来懒加载 `AIConfig`。
  * `novelwriter/gui/config_dialog.py`: 需要添加逻辑来加载 `ai_copilot/preferences.py` 中定义的 UI。
  * `setup.cfg`: 需要添加 `[options.extras_require]` 来定义 `ai`, `ai-openai` 等可选依赖组。
      * **所有修改都将是最小化的，以尊重现有代码的稳定性。**

## 新增功能必须遵守的设计标准

根据 `docs/technical`，所有为 AI Copilot 新增的代码都必须遵守以下标准：

1.  **严格遵守分层**: `ai` 包不能有任何 `from novelwriter.gui import ...` 的语句。
2.  **使用信号/槽**: `ai_copilot` 与 `gui` 之间的通信必须通过信号/槽，而不是直接方法调用。
3.  **遵循现有编码风格**: 新代码的风格（命名、文档字符串等）必须与现有代码库保持一致。
4.  **可配置与可禁用**: 整个 AI 功能必须可以通过 `AIConfig` 完全禁用，并且在禁用时不应加载任何相关模块或影响性能。
